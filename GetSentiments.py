from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline

# Load model & tokenizer
model_name = "minh21/XLNet-Reddit-Sentiment-Analysis"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSequenceClassification.from_pretrained(model_name)

# Create pipeline
classifier = pipeline("sentiment-analysis", model=model, tokenizer=tokenizer)

# Test Reddit-style inputs
examples = [
    "This is the worst movie I have ever seen.",
    "I absolutely loved the acting, it was amazing!",
    "Helloooooooo  &nbsp;&nbsp;&nbsp;It's been a while.  Not much has changed.  Still un-employed, though I have been granted interviews now so hopefully within the next couple of weeks I'll be on the employed club as that is the trend as of late.  Still doin' the same ol' thing day in and out.  Going out on the weekends and what not.  &nbsp;&nbsp;&nbsp;This past weekend went to the STL with 'Twan and Liss to visit John and for Liss to visit Wash U Business School.  Thursday:  Interviewed in the the morning, got stuck in mad traffic on the way there, smoked way too much, but I was still on time, c'mon I'm the on time one.  Got home chilled with 'Twan for a bit then napped.  'Twan picked me up and headed to Liss' house.  She brought home Gyro stuff so we had mini Gyros.  After that drove down to Champaign for the night so the girls could pack up their stuff to move out of their places.  Got into town around 930 and chilled at 'Twan's for a bit.  Then had some drinks with Schmidty and she got drunk.  Went to Silvermine, this new sub place right by KAM's, it was pretty good.  Then Schmidty and I watched American Pie 2, first time I saw it.  Then I passed out.  Friday:  Woke up and showered and waited for Liss to finally get put together and headed to STL.  'Twan made it there in pretty good time and we went to Wash U for Liss' appointment.  'Twan and I walked around, then drove around, then just sat in the car.  Nice campus, all the buildings look too much alike though.  And the houses around there are ridiculous.  After Wash U went to the Galleria to do some ""shopping.""  OK mostly 'Twan and Liss looked, I stayed outside the stores.  Then we headed to Zata's place.  And within half an hour the drinking began.  Cuz that's what you do when you're in the Lou.  John had a case of Michelob Ultra Light and we killed that shit.  Then our buzzin asses went to eat at Olympia's, this Greek restaurant where they put way too much cucumber sauce on their Gyros.  After that we had food coma and passed out at John's place before going out.  We all woke up late and headed out to Westport and went to Margarita Mama's.  Weird place, but pretty fun.  It was a really bad sausage fest, and apparently that's how it is in STL.  We did a Jaeger bomb and my mild illness didn't help.  It took me forever to finish it but finally did.  We me John's friends, and for once I wasn't the oldest, they're a lil older than we are.  After the bar we went home and they passed out pretty quickly when I put Pearl Harbor on, but I couldn't fall sleep until I got too lazy to put disc 2 in.  Saturday:  Woke up and ate at the Zata's residence.  Then we decided to go on the Anheuser-Busch brewery tour.  So we headed over to the brewery after we went to Ted Drewes, this Custard Cup type deal.  So we took the tour and were educated on the Budweiser brewing process.  Saw the clydesdales, and a bunch of other stuff.  But the highlight of the tour was the end where we got free samples!  All about the free samples.  After the brewery we went to get a pizza.  So this pizza is 28 inches.  It's a huge bitch.  Apparently if two people sit down and eat it in under an hour you win $500.  Yeah we didn't even try.  We took it back to John's place and it barely fit down the stairs.  We were all happy about eating it before we started but then after it we were all really full and kinda sleepy so it was once again nap time.  I was woken up by the sound of hair dryers.  So got up and got ready in the time it was taking the females to get ready and even then Zata and I had time to make some drinks haha.  Then we headed out to Club Buca.  Fun club.  There was an equal amount of girls to guys there this time.  And the talent was better.  One of the bartenders looked like she was about to pop out of her corset that she was wearing.  And I wouldn't have minded.  After Buca went to a college bar near St. Louis University.  It was like any other college bar, nothing special.  Highlight of the day had to be John doing the Beyonce bounce when her song came on.  He has to do it anytime it comes on or anyone sings it.  Funny stuff.  Went back to John's to finish off the rest of the pizza and started to watch Boondock Saints.  'Twan and Liss fell asleep even before the credits finished, and John soon after that.  Then I passed out near the end.  Sunday:  Woke up early then fell back asleep.  Then woke up again packed, and headed back to Champaign.  Slept some more in the car and I also was given a new name:  Google.  Google because I know useless bits of information and I enlighten people who need information.  Though there are times when I need updating or the server is down.  Got back to Champaign and ate some popcorn shrimp and watched Old School.  Then we headed home and that was the weekend.  Fun times this weekend, thanks guys, thanks John for the hospitality.  And Liss, nah you don't embarass us, you're just a soccer mom.  okbye"
]

# Run classification
for text in examples:
    result = classifier(text)[0]
    print(f"Text: {text}\nPrediction: {result['label']}, Confidence: {result['score']:.4f}\n")
